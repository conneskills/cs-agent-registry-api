steps:
- name: gcr.io/cloud-builders/docker
  args:
  - build
  - -t
  - us-central1-docker.pkg.dev/$PROJECT_ID/cs-agent-registry-api/cs-agent-registry-api:$COMMIT_SHA
  - -t
  - us-central1-docker.pkg.dev/$PROJECT_ID/cs-agent-registry-api/cs-agent-registry-api:latest
  - -f
  - Dockerfile
  - .
- name: gcr.io/cloud-builders/docker
  args:
  - push
  - --all-tags
  - us-central1-docker.pkg.dev/$PROJECT_ID/cs-agent-registry-api/cs-agent-registry-api
images:
- us-central1-docker.pkg.dev/$PROJECT_ID/cs-agent-registry-api/cs-agent-registry-api:$COMMIT_SHA
- us-central1-docker.pkg.dev/$PROJECT_ID/cs-agent-registry-api/cs-agent-registry-api:latest
options:
  logging: CLOUD_LOGGING_ONLY
timeout: 1200s
